
6. Zigzag Conversion

Medium
Topics

The string "PAYPALISHIRING" is written in a zigzag pattern on a given number of rows like this: (you may want to display this pattern in a fixed font for better legibility)

P   A   H   N
A P L S I I G
Y   I   R
And then read line by line: "PAHNAPLSIIGYIR"

Write the code that will take a string and make this conversion given a number of rows:

string convert(string s, int numRows);
 

Example 1:

Input: s = "PAYPALISHIRING", numRows = 3
Output: "PAHNAPLSIIGYIR"
Example 2:

Input: s = "PAYPALISHIRING", numRows = 4
Output: "PINALSIGYAHRPI"
Explanation:
P     I    N
A   L S  I G
Y A   H R
P     I
Example 3:

Input: s = "A", numRows = 1
Output: "A"
 

Constraints:

1 <= s.length <= 1000
s consists of English letters (lower-case and upper-case), ',' and '.'.
1 <= numRows <= 1000

```python

    class Solution:
    def convert(self, s, numRows):
        """
        Convert string to zigzag pattern and read line by line.
        
        Uses row simulation approach - track current row and direction.
        
        Args:
            s: Input string
            numRows: Number of rows in zigzag pattern
            
        Returns:
            str: String read line by line from zigzag pattern
            
        Time Complexity: O(n) where n is length of string
        Space Complexity: O(n) for storing rows
        """
        # Edge case: single row or string shorter than rows
        if numRows == 1 or numRows >= len(s):
            return s
        
        # Create list to store characters for each row
        rows = [''] * numRows
        current_row = 0
        going_down = False
        
        # Process each character
        for char in s:
            # Add character to current row
            rows[current_row] += char
            
            # Change direction at top and bottom rows
            if current_row == 0 or current_row == numRows - 1:
                going_down = not going_down
            
            # Move to next row
            current_row += 1 if going_down else -1
        
        # Concatenate all rows
        return ''.join(rows)


class SolutionMathematical:
    def convert(self, s, numRows):
        """
        Mathematical approach using pattern recognition.
        
        For numRows = n, the pattern repeats every 2*(n-1) characters.
        Each row has a specific pattern of indices.
        
        Time Complexity: O(n)
        Space Complexity: O(1) excluding output
        """
        if numRows == 1 or numRows >= len(s):
            return s
        
        result = []
        cycle_length = 2 * numRows - 2
        
        for row in range(numRows):
            for i in range(0, len(s), cycle_length):
                # Characters in this row at position i + row
                if i + row < len(s):
                    result.append(s[i + row])
                
                # Middle rows have additional characters
                if (row != 0 and row != numRows - 1 and 
                    i + cycle_length - row < len(s)):
                    result.append(s[i + cycle_length - row])
        
        return ''.join(result)


class SolutionVisualization:
    def convert(self, s, numRows):
        """
        Solution with detailed visualization of the zigzag pattern.
        Helps understand how the pattern works.
        """
        if numRows == 1 or numRows >= len(s):
            return s
        
        # Create 2D grid for visualization
        cols_needed = (len(s) // (2 * numRows - 2) + 1) * (numRows - 1) + 1
        grid = [[' ' for _ in range(cols_needed)] for _ in range(numRows)]
        
        row, col = 0, 0
        going_down = True
        
        for i, char in enumerate(s):
            grid[row][col] = char
            
            if going_down:
                if row == numRows - 1:
                    going_down = False
                    row -= 1
                    col += 1
                else:
                    row += 1
            else:
                if row == 0:
                    going_down = True
                    row += 1
                else:
                    row -= 1
                    col += 1
        
        # Extract result row by row
        result = []
        for row in grid:
            for char in row:
                if char != ' ':
                    result.append(char)
        
        return ''.join(result)
    
    def visualize_pattern(self, s, numRows):
        """Print the actual zigzag pattern for better understanding"""
        if numRows == 1:
            print(s)
            return s
        
        cols_needed = (len(s) // (2 * numRows - 2) + 1) * (numRows - 1) + 1
        grid = [[' ' for _ in range(cols_needed)] for _ in range(numRows)]
        
        row, col = 0, 0
        going_down = True
        
        for char in s:
            grid[row][col] = char
            
            if going_down:
                if row == numRows - 1:
                    going_down = False
                    row -= 1
                    col += 1
                else:
                    row += 1
            else:
                if row == 0:
                    going_down = True
                    row += 1
                else:
                    row -= 1
                    col += 1
        
        # Print the grid
        print("ZigZag Pattern:")
        for row in grid:
            print(''.join(row).rstrip())
        
        return self.convert(s, numRows)


def test_zigzag_conversion():
    """Test all solutions with provided examples"""
    solution = Solution()
    solution_math = SolutionMathematical()
    solution_viz = SolutionVisualization()
    
    print("=== Testing ZigZag Conversion ===\n")
    
    test_cases = [
        ("PAYPALISHIRING", 3, "PAHNAPLSIIGYIR"),
        ("PAYPALISHIRING", 4, "PINALSIGYAHRPI"),
        ("A", 1, "A"),
        ("ABCDE", 4, "ABCED"),
        ("ABCDEFGHIJKLMNOP", 5, "AIQBHJPRCKGLOSDFMNE"),
        ("ABC", 1, "ABC"),
        ("ABCD", 2, "ACBD")
    ]
    
    for i, (s, numRows, expected) in enumerate(test_cases, 1):
        print("Test Case {}: s='{}', numRows={}".format(i, s, numRows))
        print("Expected: '{}'".format(expected))
        
        # Test row simulation approach
        result1 = solution.convert(s, numRows)
        print("Row Simulation: '{}'".format(result1))
        
        # Test mathematical approach
        result2 = solution_math.convert(s, numRows)
        print("Mathematical: '{}'".format(result2))
        
        # Test visualization approach
        result3 = solution_viz.convert(s, numRows)
        print("Visualization: '{}'".format(result3))
        
        # Verify all solutions agree
        if result1 == expected and result2 == expected and result3 == expected:
            print("✓ PASSED")
        else:
            print("✗ FAILED")
        
        print("-" * 60)


def demonstrate_pattern():
    """Show how the zigzag pattern works visually"""
    solution_viz = SolutionVisualization()
    
    print("\n=== Pattern Demonstration ===")
    
    examples = [
        ("PAYPALISHIRING", 3),
        ("PAYPALISHIRING", 4),
        ("ABCDEFGHIJKLMNOP", 5)
    ]
    
    for s, numRows in examples:
        print("String: '{}', Rows: {}".format(s, numRows))
        result = solution_viz.visualize_pattern(s, numRows)
        print("Result: '{}'".format(result))
        print()


def explain_algorithm():
    """Explain the row simulation algorithm step by step"""
    print("\n=== Algorithm Explanation ===")
    print("Row Simulation Approach:")
    print("1. Create array of strings for each row")
    print("2. Track current row and direction (going_down)")
    print("3. For each character:")
    print("   - Add to current row")
    print("   - Change direction at top/bottom rows")
    print("   - Move to next row based on direction")
    print("4. Concatenate all rows")
    print()
    
    print("Example: 'PAYPAL', numRows=3")
    s = "PAYPAL"
    numRows = 3
    
    rows = [''] * numRows
    current_row = 0
    going_down = False
    
    print("Step by step:")
    for i, char in enumerate(s):
        rows[current_row] += char
        print("Char '{}': Add to row {}, rows = {}".format(char, current_row, rows))
        
        if current_row == 0 or current_row == numRows - 1:
            going_down = not going_down
            print("  Direction change: going_down = {}".format(going_down))
        
        current_row += 1 if going_down else -1
        if i < len(s) - 1:
            print("  Next row: {}".format(current_row))
    
    result = ''.join(rows)
    print("Final result: '{}'".format(result))


def analyze_time_complexity():
    """Analyze time and space complexity of different approaches"""
    print("\n=== Complexity Analysis ===")
    print("All approaches:")
    print("- Time Complexity: O(n) where n = length of string")
    print("- Space Complexity: O(n) for storing the result")
    print()
    print("Row Simulation:")
    print("+ Simple and intuitive")
    print("+ Easy to understand and implement")
    print("- Uses extra space for row arrays")
    print()
    print("Mathematical:")
    print("+ More space efficient (O(1) extra space)")
    print("+ Direct calculation of positions")
    print("- Harder to understand")
    print("- More complex index calculations")
    print()
    print("For most cases, row simulation is preferred for clarity.")


if __name__ == "__main__":
    test_zigzag_conversion()
    demonstrate_pattern()
    explain_algorithm()
    analyze_time_complexity()
    
    print("\n=== Key Insights ===")
    print("1. Pattern repeats every 2*(numRows-1) characters")
    print("2. Direction changes at top and bottom rows")
    print("3. Each row collects characters at specific intervals")
    print("4. Final result is concatenation of all rows")
